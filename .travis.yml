language: python
python:
  - '2.7'
branches:
  only:
  - master
  - stage
env:
  global:
    # - secure: "UD7ji6+bMAUkltQwSj5KEG4dW0uAkFIFiM9ZcQAmyXUT44U4oolBBDtKSjwmZn8OQwhy8JKMaNn5jr/P1Y7ON4qmLvH/fGH0hx4w5sX1TCrhl+rnxwoqaQKfK3Uq6wwbfyGVb4MPLBrnBj5XDof2g9KaEuBb8UmkdXhIwUvKKdZ1uhTeulZZp2CzRw+zTv4u7K0H5OUNroRT/Tkn7KGQrfzbKp6Bgb4pHw9yx3W9n33cDgx0u5sT/hnPZSj7JdW6R9B243iJMxkynVfDMmGXSgVEoDYMQyGSN1g6ABd7l2FRuwevXAJnrvUhVdrMtJyQ8jbLcCqV4++POjfscp5FVAog8TKf7jkoQbEnhgUnE/54zlIusiQceRkfICDwYHWZFWDMl4++XyQtbV5eqwLYlLE7UyMIyOE9ixhq1qGWut5/voGgzrdJ9TyeCRBHQ0unJkRq1RiMAKgePddHZHuEeqIZ9DaE2wUpjhsA3EiWQqnKlzBVq/wBr3TkZt7Imz+rQu/t2aXOB7vNAXTOS8CzU2hfI+3kdR9a1UTtEnNrY3c7yv0DFo9g3KAhogYv46V8k15sGjNi/t5NdlgsPENxP0jeJx8D1jJ/svHEyz1SfZMQ6zFChnX/nJghBjPVosD17KwraC7EYN9uhxFkbOQavgdCshSge9QDL6Xh1DzUkXQ="
    # - secure: "YO/GzUdFUXxZpgAe2HgIxA0yEytMPfUM9235UkzDWUgw9S84ht8GrRcX2t6iJs1MBhUK3DaeMD11MA8c9+gAY6tLtwUOCGJas+moYOlbEi41xypiOgwN6FYoQu243AWQcwoi79YNYSRBBSRKyVO+FrQpyNyf3xrtU8Mvahm+/ZE1q9cIHiWaEX0lrIvGnzOoN6tAebsoRVmBDt9Vsrb5gVUfPcWLyHA6vikEMY1xefADgBH158Ek4o/OmwyHtiqTu2E1PPLP6OxWeL5ZrZtIVRRCBAyoapbWGIHJpRzWOk9G95C1j2Ipb/axonHhnFqhSzKRZne4p0jP1NpiqiUBfzaBJYjre2HBJECkBSSual4DDL+uXxpwzS816RoEiRmg/PCTQK/xUcHnUM8B2cmPUrzWx4x8uIcRzeC8BsXhwHE0te5p9ZuIDwSs7wc2GkYm/iVLMML3y9QK5lQ0gKfuUYcvWHtYvyoithec0eqUVnTfCx4QCGyO59Mxv+98LKrQ9kjqppe681DDHcaYnIcFALKW0mvmcF4C/e5L7S/I+0FZ4/LEkw5BDKFxsOkA2188i0qpo0aNzakHd8GFhbcfyyVZvxq5d0bMXohldeluaDvl0QdrXNDdHgAxSbITFneptDb10uQKUQ8J/5gaHfhgRWjsZ51gQCeEmr0rUYHZRLQ="
    # - secure: "RuNWeSmNgeOL26BgbDbr4tF0Iz10LAGAG7ublOLti9UFsJTkB1SlK8mAgemKN6+HuOuXr/nXZgnD03pMIp2XeNMhX3QuNuYgJcFmQMMZNs6jsnByXWY1qVMRD2yGH1KvjKEdZu2mbuIhmXuEjBohMIVNA4BjN7qtxounEgwtCTD9Kd4/FXQrNlUR4AWO0Py0tGVl9DUsYFH3a0sleXxJDnIA7jjScqu78GNNSwPAn9XSjAFNW7F0avGteNXX06r7XZ2kmY0dxeupnsDjCbPW568QQDt9OtjsK/Eh7b05089DdPRDWMJhNT/qbpwNEokizlTV8P+CR/8VkqUaRO/42aBsE/ffcOe4piXxPgEy0DkJLlZBbWfkzHWGSBS4CMLnT5jSzEQDqIiRh2uoCl/3XK8E85PK3vusy7hRrKXIyotJ6JzWOD+9paQM0/Sup+ZTN+Ia2uMy0pq+jZ/vTKCpYtG2eEzZEOsGpmRPczfvNy4CxOxtLO3+Wt48e3Db5v2m+c2rk4d8NMs9daUKqdLCehLyZDODHaJmGdRHGOzuplqL7/X0RTaxrYimYSYL6BJ8AyHVpcHocnSQvOTg6WoM8pUHSU8RfF5UJ3ee53Bm4i1os5KeUSiay2x5+OIrSjPTaIAU6xe2cVT2paYvzg0n4IFCfJtD//9CCC7y485ekw8="
    # - secure: "muDAg87a1/XqjIjcFiM8gweHOkUnDm1H5CjJ404S6AX73IYKOhbF0wFWgQofF8zK9qwR4aYiePIoLOLdU3dh964JahTMnWMbpdidsL8ES4PC+t7LZrLMEW2qfjpwv6QyYyudFKb+4+dCtOwhHRIUUgX/YABl9LgBQ+eLPDJKIS40M2hQLQR1HkwfzDxFVzwU3LFqBl4cYw/1weB1daJ5eVFDwmLLc3htfVgesys+L2wJmdPHjqlO/08f8lQ7ivg5iBlkyvRyEzGMRz2stC+nXihLctY8M9tlbpHZS+iuz75XkW56q7YTfscCAaoSk+znEKTlrsCOvRRUmpABEarWK2ModuDLtyfP5oaGB70Iy4hLEOwXZnmdJszQOVijHtj1y8BusIQSfUK63c1p39ivk8SPO7qPV9nngrExy+5fp8J0yU/RnCQ4uEZo3obS/kwYy9nBOjeTnXEgZyHuf6BDYxw04XzTPRNUKkvODGUuffAHHDHirdRbvw4IL+yOl+02QEkPQa3ZwaxmTVqmhOMBhQc9WZNjPqrQnmuC7292dHjXYa5S0QN+MwcQJh/Uby8Kim1rFMBjzpuVpKbeJZIa2qFh2JnPWIJj4OXbF1iIYCUUVYgCwiaenO5EIKeXBaKX53UsvrvKtJhHta24JvqiiFFeLjYorpVkZWWt7Mcxi6E="

    - secure: "HnDZyu4LRUggE2/hGqg9lnLBcjnJ6wdlSjF34m4OCMUx9k1ZlU1On2NGZsgf5/bDPJ6fySX373x2yyNCSSvWzBwOQqf3kY45DaOPhkkePwJU3Xx60prxug6E5OJTTg7tr12mKDeYVwQOAIED+Nh6emhQCQP4ZGhf0dPX32eaQOzjnacXVVDSU6/WaYBjRc94/QULu///oPWar5OlxrlfVqRwj2VV4+T5iJ5yFNWWtnJjCX6uK++LxhDcSPfOWliFVYhafoxtExV7mQor3PX6Kv4HVQnorW7RH9tVnunzTsa9MYOTHJe4rtsSPcsIzNalaLQqQL0+JjecQDe2t+Y21nBdVeO1KwwWeI/HZlkfmr6BnpU1LApDbwws2E76dZm/RV3nFMde+05pM2PEvzr2TefFb0shqDPaTnka53r7G0q24qyPY+Xz7bvY3jb8rKTnxskEoc6lve1EmjLCAI+nPM2vObSq025i/s1wXfE2bQsrdMIxqHLSf/8Sb7ih7m6cc3RHyzXwNgMpI8pbg1IQEDsqoOHXgR4MsOjUJ60t9WKzZ2KGSdyyvu8HlKr5fnuRtop/BLLTJWYPcA2EHh+E+iPyX9yR0JydephEaEl781FEux2Rjj7TYpq2Tdg4OqDUFHJ2Lv8mf1uSKsSNhnRAQ4XAA0rwWwb2RrmLk6JPkLE="
    - secure: "eKbiswv4p5gCyrBbfBUpLmPkkgsl3U1CW1Nc5BePs2LOsoh8OLZoC5lxEUPO9ulzgKYf0k+/sL0jMF00jhSdIS6roSn0+BMX5hBJbKIUNADPQxBjRTYFNd7r630xR7kU7YiHDTzZSulwuUIch7+KcWsUCOB209pJ3nKf1fnmzq7jhBjFwbJQ0geh20FQwWfffKBgo7TQUc9POngFCaHfPqmuHXbV6fADBYn9v1PHjhOTtR85OhaGN6udKWeiZ/teD2mwHfYNwTr1Fv8J39q4HAc7Ah7pTH9jZaUBlWOrKpWICzO7O16JD/seoBIkHUCdLRI0oOrSJ+PHKKTmpOrjLdK34c9Jt8c0CDqsCIuJTPqEx8wmOT8O7uP7/I4SmHsavjVS65P6xR4yz+WLIARwBA0ak6aQc5d79h1hNCnUfwHkK25uQ7rf+aSKDqAVIAt+fyJaPBXNsGga/ECkUtswhA4dPq4UdpAmHdTM0wM20SJIe7UKA0hW/s2WFPWDn91s5xgfZ7DOEXJjwFyCAP8q4kuxK50h0bk/kxZdUY1gPiYs6utm3ju7Lm7bFa6qdGb8MUW2wI3lWUStMsAzd13df4VGhoTQT7XQWaM/+LYWweS5zXrljPIIuwlO9L/4/YbJKavbRiQx3cPAplRONy+0TZhFKxdeRntWY5HdRZCwInc="
    - secure: "UCSKVFAyEWBLt6ukaanv+DlCiQEiF8H5VU+iIcI4PTCR5HXM8wk3ZJHplL9Gf8pEdBnceo/kouamVlCUKdF/yBPD//NH0uoDNtZaE8ReNqwKzl5Dida1AaaopHv624IISMGAdinpjvX2niOCBqqXPxdj6f3PH7eeMfo8jI7Jk1806vJgd5Rfuxrck8TxDvu/utqFY4qjT4+yrGid5EF4Vi6PQDfxyqD9/1mksYuWQH2nXQUSwQkKcKoYDsngpNW4tbDFlIWS1yTKQLjFpYh4nHAge7UgTzaAhElqxqWi/gb047+yrmn9QXrRn21qUPPfnQ4jSGeVYm/OszfhvxSGkHe17zZ4/phsyWCSz+WOx9+JUkyjOWFGfdhyqDtEok4NPY4t2FmzaxgPzpwcdhPvnkhuvj3ZebyU2iAcisRZs0TU7PuTkUEnhbgwRiH3VKiafAVi8n1lQ/qyY5hZqvwZFCrDt77WnVDT5Dx6oypb+MwK4VRSgDsFRGs6kSOsqi6fRLnFpIKYc+jO5kAEigbx+Sz0BTtapJeADbTxrcSWTAzRPvRnz42s20ONMdg+YZcq/fKWo/sRRCtC+avl9SNedD0jSuGWvd08cLd0Idl7XH+18XHPNpE2+zZHnphY4AjERPXpYvS2/zaCYZpsPX6QCvT90zcVtl5SudN1mwQ9HbQ="
    - secure: "VPwqzjHDqPTSitNU1VWdgD/BZaFeGy2jKou9ImFVqSM0OZrASD0yD2IM+dUZWZlA9bcLiG0YPnxvsnne0Iy59JdDZMzavGHhyTLSrHYRcFlERJG/e1LYCfGTTymJoMIqUg0ZDtUN4eh919ityene5D/ejk8HJ/yNbtmNPpct5zr6HB/yyp55frZ4D84oxVriEclJvymZcEHpV20AMEq8X+idVqSci/ixlXeL52MjhqTLLvNHTUiWzkLghmQYgpIGmZfx2NEkmbbRgi98lGH3wyPepxNjq8wduIDwBqtXAFYsefpZRq+OW08TC/dgpBI8de6ahkHlqam/Ibp2+Wy3tVnBoywSwjUt+oFOkVCQ6AeptciHLPMx7Fvxp1WPM5hoitYsNI/aZS6KxeHVtANJc1ijnIBfK+FkOMr2kIdipL/z7cv0bfFh5WZ6HCAERPCC9WDao39Sd0UfFUgbBkbgpl2vHy1M/lcR6V2uX2Ars5Fa2OunLaASo7e9PAmKSYcS0Vfd+Yx0Axfgx83g4oGSCLeOBpJ7d0BxdapiLHsNaj2gU0jf7tKNVKbcTUXNAVCPamv7rW5buJV9LvA369bsL9R/1mbeDanM4Jw4i1S3FrMR7IOEXKwTaAYbdmmPNTkXma6D7WI2jmprATP3MPjdByXJUv8rJJb1uR161jEnHL8="
    - secure: "aNyHeMpJyBa51p4SblRf9mSDPYrvZ3X1eskoC6L1kVFm2auOzVb/k1CwlBt6S2gUa5eXLs6L8qJtS/DZzr5ChLAfIT8hEEN/dVkARqaqGPJMSxK7ixLkSRJWiJ5hUJqIUa8UyDm1SoPq4wuDSqjyBW830tYap7ramsKRotJk4szNsHviEadHTans+xOTkoQjdQHUOw4vO23oDwv1DJLrsh0Mf4fmXYteWmtGb9fPegqUtRWRcOcKBMhSFBWdbf7r5loOPTE9RfARbnELjcgP088ylNSYB0J1V5njq4DpH1zQQAkgs74wNcmyL9gYAp+zN9zQxAZ3EoZi4ormbq/A0wgb2bGavTSsGDxsoe338HhXKYxmLHtAStzxe/zZPK+H9vk66hwWNr+VM5pYmjptaZv0kQUPkcMA1Pe4QZ53PND+O0VHazjbmnNkzyW/caw5PqEfR1BDD68yoH3elkjWhnJXrhIBUl2epKjvuhvocfun5BAXvma0enMuhMmxGoEYoLu3CuPqxMhBR0GqQt/aN5iG/Y341Sa2rGc9DnqqYUPUcJ9GYbHmxWUa8uwOHL5bYfaxf+pj1mUVaIWpZo8+zpa5v3v5Sg6j1Bo6nRYk7Vh2H8vzFoPEq0iqETXLSTJBtdLpS/qVBCRqQtr8XMYfVRp5kZnQodeCifcIPYLrklE="
    - secure: "ltsn6iozPx1NyIN+Kz1LD6fUlrmH9LQXHQQkt+37MsEOYYiMDGBBOVALhWS0cKDJ4gDnscWUpLi+p6HQbxTkMLdZ4eHSV6MOOSysu5RrCqJjNv//PWEAZ7S/Lgn1khV4QOAoAgjK9EiYy7+kkQgmOv+9+pLIdq537GA6FtcO2Q+PJ+FZrFq5cBrIWTxij8rrj1hP5NwdRomrZuHi+13DZDbz5Sv70g3RZKU+eWhwHjH7GTFQIXf+EP6U3pFfaAuQf1LSL5XRBXeO+Y2mNrOJSPRiaIzDRlyBUQ3QJ6fzmA5iQtZUT1bwrVxVWxzTJoOfq6tlBWTsaZivxPXhWippqcYI3+CrsWDq+js0Dv2+UdPEizEn7RhyvtLYh6nWccb1ejDwjb7dMsEwKKlWeVOpIVPffLCdjfM+tC56DsV+5mHsqOdfDSn6W8prRt+oalLPtl6n4rqae2Ht4PpOiQi08CXF0HjB0924o0GYJtuZ+MLIGokiCXeFtFX0gM/7m+fFjI5eo67jwg0e/RZu/4m82B7Co93NGBxYCq4W+j3vvan8LcdD9R7CuDoiAZtPwwCj/DZMZwybH8Eb+Z8rQFAC9LiSVDP3DkuR4QruS8VZ0KalHFT3/s+inGDIZRkjd9UCE4oq/63zHr4l1UUa8gcM57SlHnqEnEEJ5rYO8g/mQPE="
    - secure: "IKgyvNycz0IgRV7bymM2my4/79v/pvmA7cTamhN7mb9k+wXFKICcn2zVE4XA3noi2e8T/b3VnPJtYvNqK2ozhx3UR1cMY41eHFnBil94t4oADh3m6RjyZqA+FQL8ROtYbPg/FdKd1U7RyVS3PQxnF7UrHbLvzV7i8QoxIQIOz53lcAI7i1Qzt6ra5qYe+1n2Po0W0+wEXkzIeyA8SwZ6d8BV9bY/5MCZ4ERWXQ3HU1hHhabSTuIqMkMvkfN4DgNYzGxCh2taBvan/VeFXiyMOIsFadIAISsiXAiARKe1kl+8VVu2cnbNvMrFhWR78MgRmJWBKONsv/6PgK0+MZOl9DngVdyoz6k9OuetsWyMcY7THbzKcmy8h8jXjO6mUUz530LoIMGN47pC95/PcRy8udHq3n3IUeBKk31HWznh0ragb5eBPf90rFtUiREzQAuB26PrxnlDbWjHnjo20l76oxZMmG+GtoVHQHzD38Ze8Z1bfwM9iaMkz0PWJuS4fr8NUpCER4gLNo9Yer4DMEv2bPIOM0SfVnX85Wk8JEdHvW/G4FkQncBene3orYAbarVL/GMYEyqhFi+BQDZX763SNxJnNwapkLHFAADMdu3R3nI6CIj6MKpan+IwGlLiZ9vPTdTYAqNVFeqSvjmYDIer7FEHS1AJtoswBdjPT4Nd3/g="
    - secure: "peE60QrES5Pay3j3LCgH3qHFi9Sf526dYaur0jcMkVq3nVyjUci2YDrkswJZrwa1grX38MOGjV9NYbPiZN7eoykEhTXiu9ETDe2ocNEJ/UF9+2htNLfF/FWjkPATzj5SGaBAcEQsYEcMBaPtKewJj2ArYRUR/udCgXgIFK4NXNx+PGFBvLId32CV5hJw7TxLY8/glS3vNkD+BBb/N9mfE+fM+dGT5iwriBGU53oMWUMVX+5cAMo9wxtqmLZi/QO9d0RyVGt22LsJGXYeqW7Yx8fwgCnyWcoG8tFc1FZazpNLGulp++eWMzR2HRvJz829hV0a9L7+SQE0dB3W7DvLmZBwod4ca0+FBHym5pgFSmTrbGaVw9LY7V14HasHQruPNpTTyTTMJlGDdiqQNtMYJQBk12q9ETMRNAnGX+1IdZHnczmCTTVNDUyZha8njbb02rknJOF4XNBVEUpX9BOD74VTEvhKr7I/bwRJFoW63Yav9kJ9lBYnOS6+zDbYXAPFMNx3tnNisaQiNvM0rBjOxPoaPrX53k2RQam6SAMVcrA/FhJSAAUTw8Uyy1KhjhzfGtjMVCYxN4O8lANQv2xvQk9FOczrEsBPjuV/aP0zbzohbYOVSR/w5PwhqN3kzpGfEV4LznuWtmJmf1HyWCQklOtoE1qtfUecJ0OKqfm2Lfs="    

before_install:
  - sudo apt-get -qq update
install: pip install -r requirements.txt
addons:
  postgresql: '9.4'
  artifacts:
    paths:
      - ${APP_BUNDLE}
services:
  - postgresql
before_script:
  - psql -c 'create database demo_db;' -U postgres
script: nosetests
after_script:
  - echo creating software bundle ${APP_BUNDLE}, pwd':' ${PWD}
  - zip -r ${APP_BUNDLE} -x venv\* ./.\* \*__pycache__\* \*.pyc
  - ls -l ${APP_BUNDLE}
  - ls
  - pwd
# deploy:
#   provider: s3
#   access_key_id: ${ACCESS_KEY_ID}
#   secret_access_key: ${SECRET_ACCESS_KEY}
#   bucket: ${S3_BUCKET}
#   skip_cleanup: true
#   region: ap-southeast-2
