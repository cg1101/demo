language: python
python:
  - '2.7'
branches:
  only:
  - master
  - stage
env:
  global:
    secure: "Sw+Xxoyp4NEhXrUd9LlZ3UVeOPmGMRGYEE3I7YuN+Xjj+dPM4C5pCY4Z/5gsjWCqBpIUkRxxwXAW1k9SKO1Og1WnBQhYGP2XD1r03rmDL8j8ej6ffVi1bdaI/WRkfJguC1/w7QQDa2LzRTFqAVI0zHB4hmQm/VrvMNYF/H8IT5F7S9J8QQyE4bs7tIdTok36LfgAghW0oxr88Fs7W2LKhjUjlnIQM3KyC7HqjXmpIchZSvQkSii759KMdgMtixnQtaCHhz+3TahLFRcwlsKkrd+mycFxF2BKbCgwX5cYDCCxMTkg2rZ+aa10XiAk+dRTkoB+ly2bKK+nlqsNdxa+kOCfkGg51JvuqOcMDYjUGJg1a5jY+5s7ZT6jXkQiEDVpyy9beghOYVeBcMyQaBEXjolc9adKb0IhykFWE/WgeO5B8X/SGXTqIKX3FhOzF7SRHCo5pdRKRkAGpe7b13LPx4ajgw25slwEqAw7vXA6tapu6NZ+1DHpsglugOwcP3hLIyr8UIV4lyNGAd2inRQoQ+eOFuVJvRPchze6ivPR/1fU6il+z6bklM4flYeprYc+t7X+Ev+2P26CxAHSDNoVAbSU+CXVV/jw3i5fvqPHyzcrkdWXeGxOFIJ3EIPvr3vhiDmn1HSUn0gS57EIjkCx2T0i3UTqiYbTYS4oWcA0uEk="
    secure: "QPD6k+NGb03f7MrJlA1OlvrbFnk60WnhM3N74CY1vQxrP62QqCLaP6hmRZPVjNF98+YJJZXeD5kuVNlUit5GPFDioxpZOLFoPRpOReXJKf7OYOrIRXouCbR+mNI2S2ROmTHvaLcwhA7N8ilXeKP9exc/GCgIA5CmUaaGHzNAoffTe/QA6OKF94u+Hc7YfjQNhSQmrzCXHcavd237kHK0bP/CxMI1cAbUqbxYP4JmWfZ+6r7FidJq3DwG8wHRVHvN7v1VjZes73t+uDWcnf/F4dynrYQiO9M3jkD0pEpMA2fWJTrMcD/Q2bh38Pkf1XZ6AU4uc7hBOnWcxeV6spYtp/NHYb7kpb7FGSjbZEcNcktI7/CnCMTpWN+O7INSd8aDu/7/U0NRvFHidspTRmapxiI7GRu+tvO4eIIaCU4Dd7jcA0GJGfbuuLGiCEi0wIc7XwzC87JeJ2jobmi3rWqduRhlvwusSD0mw2yNi5y1AONd7VbG4xAy4aG8az5vAbqzd2lQI28B/Ck03f0OTj6vn6u6aeTcxAFuI5j8l9hbSS4EzPI9S2JkxNPQruMUk0j+QJlNu5bqBte67L2QRsIaBnBC9nLm2tuyon7G9QH2Pa7/jfoIiMEh/PE/pm2Ecsu5M7HrePAeB70/72cnVZ/ApLQafiwPlFBcUPPu+LZM8TA="
    secure: "KFqAmSIYnCkSC7K/l6j3QCxJWmDlETwDfd4ubCflJ/KNlfyZk7hlDX2n2+UKTDPDqDbRSUpRLIPR3LLF011Ky5mAQsH20nklTWa/INTXFU1Gce00xvGqnvJLJEaJwcT8C1hpQ5CIiExzVATHhR5rykD3oW62EnD44jEA+Hw2O6rXbGxj06eoCqsSsXf6iskxW5RNZGkk5G997bvkiXgANA/FMQDkqtR395rfcRwy6ucUuskT//twcDRrCqr8PuPGOa1j0vRHB9fQlVFb3E4OzSqevBDbpkLKXxdCQi+nPH569kecZcxhO504cnfVNhAPUFFJ46KxFlPePaTU5qL8URDBTzkuLHZCsTtQBmKtKeXtjKriFDmnCtEC+WfzUCbHZ+E34gbxr0I7f+IN5VVT/0toHU8/lazwbxRdNd6tLW/6YjsZBLKke3HulrJ7T47Mz8XEQT0VCof91oHpEuWYlMHjZot22MKFqa6ftoxldAk581JTaY/Madmbw3gWsnwcO7LxgClulRnYYjCyWA4S0gTcYPvXxiYcSZX0LrE7yPOURmHZQlXJQCVbmUyNihUW+iLP0zIQifBshTPvIoVOxoC3iFLRGYSVCUpiZW3aZ4UPKM8/82+tcfTPxydIdZqofRXMMGuCTV3Faqr4VdlX7mssY0I3clqXaArqCf9s/6c="
    secure: "dgtEi2j0yEW9ee2QG805+1epAB1dRqiL9D51M29jAnzWak8c4mYBXSrw6y/TlNhAzw6jw6VNCWr5/JwI3j1tt76XzVuDQT5nfczXUYDcyehYeYbwwfO3/4mJA+c8fxWDRCCN89nDVx/kxRZv3wQ+mz+fwIo2eD3srbGNxbvkQTPExBq28s+cr23GUfqEHMPRJQv4lqXTcEK7xeBMNF7jHAIWL/tBDswWs1XBhw114jGig6hyMkn7krpsb4Qo67/uF4MkwSbfyxEqcbFe0PIvOoE9kkN0ExL+sHTez9cGxT4H5hR8O445GCqSheyoPK754bkOgEkNJ5bZn/umQr+H2xWmCQg2UwsBH7BsuP/FppOekIFBpG/eRFCG7z+WJb7fUzGQqgka07LN1Op/F3QKlsUj0ZGXF5jsCrz3Kq1WZQWrCsfYDRRc2t+0+f4VwhU8T0vH8DN1wNaZ4o5WmjCSBG3Yy+f/Yv3VqrjDrTbVGHrh9hYSNMDisyenCKDB5g0XLPdko7WTKDaEx0JUZ1oNZ/j1c6PA+k4IGymTh0H9LrDI7cRVAZmU163sRYayw8l3lNx9hzSlq1oyHO5G2obVZ3JmiJuOox/yTEjyE31oiCKD/cl8as8TLNW1xTkPFa+gg7LrvAYInxHSS0uHsoRJfjgrhbt+hTTQmJyuJv7mtI4="
    secure: "WIzZCHN6GgxMc+945UFK//DnnyN2w/A/JzFI8w6/9NOjyaQ2C7yhz2RD3PyIr+0KyRN0w7qMhbrGMIg0p3TRNdqR8wHrj9tfF2fk9inh8CQf8DeZxZImiVs090DtPkSLzRoZqxPLaQ2A6MG2XyVtj966P87fFNSUj0eQHd4d+nNWMOUsWX2TYN6yLeqxiSEyP16RMEH5zMfwPcR4P3Fon1Wtxkfo4gIfrq8b/Zo3bsCovhiuF2vKsKDVW0NhvgbUpSrMv+kPH7vaYf1s/oZ4D2RksSMkbdPH9RGHN/EbF7efLN2HGK8coQV9UOLyaDhSekeFs3/jQtC4GgLJ7S93kcawIIjDUYvCadkZOTA2c2remplcXi6wIubxqWpa2aWxs3U7ZEB2ZOQRT1PsQsOoXReipM7a8CkO8aAPoNovP/5NYz2EsRdQa4RPaACD69vdJK32kqVeoq1vgzxeKObapXFB1uRFjuxZPbpYph4EizkniBEt2lC4pA0PDZvWuBTeOjTyP3k5mLQgKIP6mlfy7C3th9zQaAztuWcJ070+jzM267KpW1EasX0wqBj1TihmPjzUK1tBc5b6OwoPWMNqn5jIaU5jktyTu6WjY8yQg+LOqkb/z3quFcqIP3IJS5UZOlmMnx2bXfmIeK0dWdK4+sLKu5WVSjYc3qP0tv5x194="
    secure: "L9UoneDKhOo722Mi1K38dSrK8uRrwsUJstpOHCBunyBxCiQjbEoLw/DxgY4lzpPUcbnaP4FGb7edLG1cyjrzYZ4LDa3Lw0JE5FVtjF8EGGqzuJui3o5I/KXLzAnoeJOAXePZ/JyQ8XGFCDlKCdVoExbInqL2hrxu4ew+P4de2H/+y1R6y04/nNetOLVVF+XlnHB1o66kPjmu3Bop0UUckVT91qC47ROIVp40f6g94T/SNhswaif3wWMf4svD4FaEkYCytQxfzpekI+zwjoEkPAALWoTkkpPJfPpJFatpB1aJMag2qJOROTewvdVv4eMTaeShi2vzkc+lrtgGm/vbA1/v1Q9TQJ8AEUJmRXVdACEq7l9o/HSP1kdkBiukpYS4+5egW2b9zOgpq9XU0Si7ca7MzzFM9ggrxnvQPGmC1DB7lOwUiMfJ6ZncR/zI+b7dVpqsWnA/7b8jDbACzu8WJOOaglrrQuUu7K7+O70BUjZYNTTVh6JrfcmeB3cZmNLm0T3wTlfNutX7opaMxaLtTttVQLSZt1bXJ9AJW3IVtFvbdH5cps9AMpqvxW4cThEjhwKGLK5YMWU9UvS1IVOxXJDRxBZIg0C7dfQ/akRsJUu2Nrgnl7Nm/cOx7VLbSHX1no4ILB8ACd/p9qX+i53bZ95Xeo8BfPzQIk289yWRoB0="
    secure: "J4hrRu/I6Kldnte6AMl3teEwnxEkzfL0SIGkvb2FFDCbpLKciAPZQ90RHNO2v02G0C76fOso5EbZJdZlMi1QKHhw3CTs6wrPGMu2R7aYsggl5yWUVXtcGH8evQmrsRf5jsr8rVz72NfLJxSGV6i/9Gu3P899wKlctCIl7hQahJU4f8ARy9ac9sqoQsuZZItIX+apzYjeSgv0hv+vZii4jKr7BAZX0oHBu8hjb+oJdfLafdYtF+JpZdRRAa/As7diUz68mLHxJjhryyQ4xAwfjQLXV7EryiJt3ODE/MSHvlakZIfQ85ZG+rANmBf6mbWAak2/8XC4bT2dVdbZ1TGZsrePJFH6f9TnVbRwL80tctep8Pf+AuzYoXJsN2lz/UEt2QGJy2k1ce+KOfLpsA+aUtD4EBp+3Sis5NbxEm+pAbZwlNQWTFtJUtaY0tWWjBWWS3VjiFR+rI39J+zIvqER9bJ1Xo4dXRgpj4XKy7o+0NT/otwBuYjxznlBe3xMb+DoEforFDLeULCyty+6ewXlDIDMXJaf6+WSHDK7iJQv2xdusQJ/XLwJ3BY6ihRaV3u937rquK0yi6akcEvb4HCFVEQOw7Z+B+a3zImhFPth/O9iHdmdpxRTnTf7v2V/HgaWbGKNrV/N4LYvjcHLGwnfQm/ttEl4uW8ZTBi5CbwQpHw="
    secure: "q51J8p9NGMNdYAD8KrUczUDMSpP+DdBYWNvF9LhRRWHiZBmZTANxljpzpu263nWhML7aOnt47zeGyhu/Km+Ls8Znocxb9x+WB2SgldQ0mXFk0CZpdACetQ2YVqLoXMwEZvWjsz+9lDt4G2oZwmBT1dgrBxmY7TON99RH/6j7heY40WQOrUkhyyqfY6NiOLwbQBEAwlnlvWb77HhdgUMs+lM7mcXvVANAJrCfsdrb29bIJuWlR5e2SdQk0b0s8QmIj2qSBZuDvvlqU+Q1BvtSjoI0IE0RfKsHLT8+HSTGGeYEhNwVb4qtZrGHobJwcJVeESb8j0/hL4pNnXBV0zY0Dr6yf3iv9MdwmvJSz/UWJLs6ahongXK3cCk962vYmuQhsFqsTdO1woUnWVw/IUyvmkOwVxyEQWlHWlV1P2fC7vn4TxIljlU8xkkmKvHa53U7i+fH0vnTER00V3PQ5BS1+s/P8V2ULgABuTxTsx7ktoqee2bnwbRMQS+xBSowJmLc3bUTSkRWdIjRvsEpH2dbP5LoZTTYSP+NvjR9AV2Q5S4dy2d1Q7RD0gQuNyp7hWcUEl/5TuxbsfqP9bWnTkUvwzrWlrE9IYdyBI6ThK9FStFEvaVLKiiQ6UNytauz/5I9f6kOX5ylijx1xpI3XLBH4mYdKyyUnbXPExgmhNywoz0="
before_install:
  - sudo apt-get -qq update
install: pip install -r requirements.txt
addons:
  postgresql: '9.4'
  artifacts:
    paths:
      - ${APP_BUNDLE}
services:
  - postgresql
before_script:
  - psql -c 'create database demo_db;' -U postgres
script: nosetests
after_script:
  - zip -r ${APP_BUNDLE} . -x venv\* ./.\* \*__pycache__\* \*.pyc
